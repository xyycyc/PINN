# PINN 约束方程详解 (problem.py)

本文档详细介绍了 `problem.py` 文件中定义的五个物理问题所涉及的全部约束变量和方程。

---

## 1. 简谐振子 (HarmonicOscillator)

这是一个一维(1D)问题，求解位移 $u$ 随时间 $t$ 的变化。

**输入变量:** $t$ (时间)
**输出变量:** $u$ (位移)

### 数据约束 (Data Loss)

数据约束施加在具有“真实”标签的特定点上。

1.  **初始位置 (IC):**
    在 $t=0$ 处，约束网络输出 $u(t)$ 的值。
    约束方程: $u(0) = 0$

2.  **初始速度 (IC):**
    在 $t=0$ 处，约束网络一阶导 $\frac{du}{dt}$ 的值。
    约束方程: $\frac{du}{dt}(0) = 1$

3.  **内部锚点:**
    在 $t=\pi$ 处，约束网络输出 $u(t)$ 的值。
    约束方程: $u(\pi) = 0$

### 物理约束 (Physics Loss)

物理约束施加在整个求解域 $t \in [0, 2\pi]$ 内的 `t_physics` 点上。

1.  **简谐振子方程 (ODE):**
    约束网络输出 $u$ 及其二阶导 $\frac{d^2u}{dt^2}$ 必须满足的物理定律。
    约束方程 (残差): $\frac{d^2u}{dt^2} + u = 0$

---

## 2. 热传导方程 (HeatEquation)

这是一个二维(2D)问题，求解温度 $u$ 随时间 $t$ 和空间 $x$ 的变化。

**输入变量:** $(t, x)$ (时间和空间)
**输出变量:** $u$ (温度)

### 数据约束 (Data Loss)

1.  **初始条件 (IC):**
    在 $t=0$，对所有 $x \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(0, x) = \sin(\pi x)$

2.  **边界条件 1 (BC):**
    在 $x=0$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, 0) = 0$

3.  **边界条件 2 (BC):**
    在 $x=1$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, 1) = 0$

### 物理约束 (Physics Loss)

物理约束施加在整个求解域 $(t, x) \in [0, 1] \times [0, 1]$ 内的 `tx_physics` 点上。

1.  **热传导方程 (PDE):**
    约束网络的时间导数 $\frac{\partial u}{\partial t}$ 和空间二阶导 $\frac{\partial^2 u}{\partial x^2}$ 必须满足的物理定律。
    约束方程 (残差): $\frac{\partial u}{\partial t} - \alpha \cdot \frac{\partial^2 u}{\partial x^2} = 0$
    (其中 $\alpha = 0.1$)

---

## 3. 波动方程 (WaveEquation)

这是一个二维(2D)问题，求解波的位移 $u$ 随时间 $t$ 和空间 $x$ 的变化。

**输入变量:** $(t, x)$ (时间和空间)
**输出变量:** $u$ (波的位移)

### 数据约束 (Data Loss)

1.  **初始位移 (IC 1):**
    在 $t=0$，对所有 $x \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(0, x) = \sin(\pi x)$

2.  **初始速度 (IC 2):**
    在 $t=0$，对所有 $x \in [0, 1]$，约束网络时间导数 $\frac{\partial u}{\partial t}$ 的值。
    约束方程: $\frac{\partial u}{\partial t}(0, x) = 0$

3.  **边界条件 1 (BC):**
    在 $x=0$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, 0) = 0$

4.  **边界条件 2 (BC):**
    在 $x=1$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, 1) = 0$

### 物理约束 (Physics Loss)

物理约束施加在整个求解域 $(t, x) \in [0, 1] \times [0, 1]$ 内的 `tx_physics` 点上。

1.  **波动方程 (PDE):**
    约束网络的时间二阶导 $\frac{\partial^2 u}{\partial t^2}$ 和空间二阶导 $\frac{\partial^2 u}{\partial x^2}$ 必须满足的物理定律。
    约束方程 (残差): $\frac{\partial^2 u}{\partial t^2} - c^2 \cdot \frac{\partial^2 u}{\partial x^2} = 0$
    (其中 $c = 1.0$)

---

## 4. 伯格斯方程 (BurgersEquation)

这是一个二维(2D)问题，求解流体速度 $u$ 随时间 $t$ 和空间 $x$ 的变化，这是一个非线性方程。

**输入变量:** $(t, x)$ (时间和空间)
**输出变量:** $u$ (流体速度)

### 数据约束 (Data Loss)

1.  **初始条件 (IC):**
    在 $t=0$，对所有 $x \in [-1, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(0, x) = -\sin(\pi x)$

2.  **边界条件 1 (BC):**
    在 $x=-1$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, -1) = 0$

3.  **边界条件 2 (BC):**
    在 $x=1$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, 1) = 0$

### 物理约束 (Physics Loss)

物理约束施加在整个求解域 $(t, x) \in [0, 1] \times [-1, 1]$ 内的 `tx_physics` 点上。

1.  **伯格斯方程 (PDE):**
    约束网络输出 $u$ 及其一阶、二阶导数 $\frac{\partial u}{\partial t}$, $\frac{\partial u}{\partial x}$, $\frac{\partial^2 u}{\partial x^2}$ 必须满足的非线性物理定律。
    约束方程 (残差): $\frac{\partial u}{\partial t} + u \cdot \frac{\partial u}{\partial x} - \nu \cdot \frac{\partial^2 u}{\partial x^2} = 0$
    (其中 $\nu = 0.01 / \pi$)

---

## 5. 热声耦合波动 (CoupledWaveEquation)

这是一个二维(2D)问题，求解声波位移 $u$ 在具有**非均匀**温度场 $T(x)$ 的介质中随时间 $t$ 和空间 $x$ 的变化。

**输入变量:** $(t, x)$ (时间和空间)
**输出变量:** $u$ (声波位移)

### 数据约束 (Data Loss)

1.  **初始位移 (IC 1):**
    在 $t=0$，对所有 $x \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(0, x) = \sin(\pi x)$

2.  **初始速度 (IC 2):**
    在 $t=0$，对所有 $x \in [0, 1]$，约束网络时间导数 $\frac{\partial u}{\partial t}$ 的值。
    约束方程: $\frac{\partial u}{\partial t}(0, x) = 0$

3.  **边界条件 1 (BC):**
    在 $x=0$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, 0) = 0$

4.  **边界条件 2 (BC):**
    在 $x=1$，对所有 $t \in [0, 1]$，约束网络输出 $u(t, x)$ 的值。
    约束方程: $u(t, 1) = 0$

### 物理约束 (Physics Loss)

物理约束施加在整个求解域 $(t, x) \in [0, 1] \times [0, 1]$ 内的 `tx_physics` 点上。

1.  **耦合波动方程 (PDE):**
    此约束的核心是波速 $c$ **不再是常数**，而是空间 $x$ 的函数，因为它依赖于已知的温度场 $T(x)$。
    
    已知函数 (来自代码):
    - $T(x) = 300 + 700x$
    - $c(T(x)) = 5000 - 0.5 \cdot (T(x) - 300)$
    
    约束方程 (残差): $\frac{\partial^2 u}{\partial t^2} - c(T(x))^2 \cdot \frac{\partial^2 u}{\partial x^2} = 0$